## DevOps зима 2026
## Лаб5: Работа с переменными в Ansible

Сделать ansible-плейбук, который на целевых хостах:
- устанавливает сканер NMAP
- копирует файл со списком целей для сканирования
- запускает NMAP и сканирует цели
- Собирает результаты сканирования (stdout)
- выводит результаты сканирования


### Предварительная подготовка
Запустил два контейнера ubuntu. С которыми можно взаимодействовать по сети через ssh.  
[docker.md](docker.md)

Установка ansible на хосте
```
apt install ansible
```

### Inventory
Указал два docker контейнера на которых будет запускаться скрипт. Для соединения по ssh указал порт, пользователя, ключ. Попробовал вынести повторяющиея элементы в раздел all/children/docker_containers/hosts/vars - не работает. Заметил, что стиль оформления inventory.yml отличается от playbook.yml. Видимо, исторически не указывают ---. Нет списков, обходятся словарями.   
[inventory.yml](./inventory.yml)

### playbook вариант 1

- Установка NMAP
- Копирование [списка целей](./nmap-targets) файлом на все сервера
- запуск сканирования с переданным файлом в качестве аргумента nmap
- Вывод результатов

```
ansible-playbook playbook1.yml -i ./inventory.yml
```
[логи выполнения 1](./log1)


### playbook вариант 2

- Установка NMAP
- Чтение списка целей локально. Используем loop. Запуск nmap c параметром из цикла
- Вывод результатов

```
ansible-playbook playbook2.yml -i ./inventory.yml
```
[логи выполнения 2](./log2)

для интерпритации строк используется шаблоинзатор jinja2
